{
	"info": {
		"_postman_id": "af3d5b70-8ebd-4c1e-98e7-42f4f7a3e76d",
		"name": "SecDesk Security Management System",
		"description": "API collection for SecDesk Security Management System",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"description": "Authentication-related endpoints",
			"item": [
				{
					"name": "Login (Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"password3\"\n}"
						},
						"url": {
							"raw": "http://ssms.web/api/login",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "login"]
						},
						"description": "Login and get a session cookie. Provides authentication for subsequent API calls."
					},
					"response": [
						{
							"name": "Successful Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"password3\"\n}"
								},
								"url": {
									"raw": "http://ssms.web/api/login"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"message\": \"Login successful\",\n    \"role\": \"admin\",\n    \"userId\": 1\n}"
						},
						{
							"name": "Failed Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"wrongpassword\"\n}"
								},
								"url": {
									"raw": "http://ssms.web/api/login"
								}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": false,\n    \"message\": \"Invalid credentials\"\n}"
						}
					]
				},
				{
					"name": "Login (Customer)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"alice123\"\n}"
						},
						"url": {
							"raw": "http://ssms.web/api/login",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "login"]
						},
						"description": "Login as a customer. Customer accounts have limited access compared to admin accounts."
					},
					"response": [
						{
							"name": "Successful Customer Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"alice123\"\n}"
								},
								"url": {
									"raw": "http://ssms.web/api/login"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"message\": \"Login successful\",\n    \"role\": \"customer\",\n    \"userId\": 2\n}"
						},
						{
							"name": "Failed Customer Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"email\": \"alice@example.com\",\n    \"password\": \"wrongpassword\"\n}"
								},
								"url": {
									"raw": "http://ssms.web/api/login"
								}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": false,\n    \"message\": \"Invalid credentials\"\n}"
						}
					]
				},
				{
					"name": "Check Login Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://ssms.web/api/check-login",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "check-login"]
						},
						"description": "Check if the user is currently logged in. Returns session information if authenticated."
					},
					"response": [
						{
							"name": "Logged In",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/check-login"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"loggedIn\": true,\n    \"user\": {\n        \"id\": 1,\n        \"email\": \"admin@example.com\",\n        \"role\": \"admin\"\n    }\n}"
						},
						{
							"name": "Not Logged In",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/check-login"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"loggedIn\": false\n}"
						}
					]
				},
				{
					"name": "Logout",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://ssms.web/api/logout",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "logout"]
						},
						"description": "Log out the current user. Destroys the session and redirects to the login page."
					},
					"response": [
						{
							"name": "Successful Logout",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/logout"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"message\": \"Successfully logged out\"\n}"
						}
					]
				}
			]
		},
		{
			"name": "User Tests",
			"description": "Endpoints for managing user tests",
			"item": [
				{
					"name": "Get Customer Tests",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://ssms.web/api/tests",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "tests"]
						},
						"description": "Get all tests for the logged-in customer. The user is identified by their session - you must be logged in first. Admin users can see all tests, while customer users only see their own tests."
					},
					"response": [
						{
							"name": "Customer Tests",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/tests"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"id\": 1,\n        \"name\": \"Website Security Assessment\",\n        \"description\": \"Complete security assessment of company website\",\n        \"status\": \"In Progress\",\n        \"start_date\": \"2023-10-15\",\n        \"end_date\": \"2023-11-15\"\n    },\n    {\n        \"id\": 2,\n        \"name\": \"Network Penetration Test\",\n        \"description\": \"Testing the security of internal network\",\n        \"status\": \"Completed\",\n        \"start_date\": \"2023-09-01\",\n        \"end_date\": \"2023-09-30\"\n    }\n]"
						}
					]
				},
				{
					"name": "Get Test Targets",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://ssms.web/api/targets",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "targets"]
						},
						"description": "Get all targets for the logged-in customer. Can be filtered by test ID using query parameter ?testId=1"
					},
					"response": [
						{
							"name": "Test Targets",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/targets?testId=1"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"id\": 1,\n        \"test_id\": 1,\n        \"name\": \"Main Website\",\n        \"url\": \"https://example.com\",\n        \"ip_address\": \"192.168.1.1\",\n        \"status\": \"Vulnerable\"\n    },\n    {\n        \"id\": 2,\n        \"test_id\": 1,\n        \"name\": \"Admin Portal\",\n        \"url\": \"https://admin.example.com\",\n        \"ip_address\": \"192.168.1.2\",\n        \"status\": \"Secure\"\n    }\n]"
						}
					]
				}
			]
		},
		{
			"name": "Admin",
			"description": "Admin-specific endpoints",
			"item": [
				{
					"name": "Get Customers",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://ssms.web/api/customers",
							"protocol": "http",
							"host": ["ssms.web"],
							"path": ["api", "customers"]
						},
						"description": "Get all customers (admin only). Returns a list of all customer accounts with their details."
					},
					"response": [
						{
							"name": "Customers List",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/customers"
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"id\": 1,\n        \"name\": \"Acme Corporation\",\n        \"email\": \"contact@acme.com\",\n        \"phone\": \"555-123-4567\",\n        \"address\": \"123 Main St, Business City\",\n        \"created_at\": \"2023-01-15\"\n    },\n    {\n        \"id\": 2,\n        \"name\": \"TechStart Inc\",\n        \"email\": \"info@techstart.com\",\n        \"phone\": \"555-987-6543\",\n        \"address\": \"456 Innovation Ave, Tech City\",\n        \"created_at\": \"2023-02-20\"\n    }\n]"
						},
						{
							"name": "Unauthorized Access",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "http://ssms.web/api/customers"
								}
							},
							"status": "Unauthorized",
							"code": 401,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": false,\n    \"message\": \"Admin access required\"\n}"
						}
					]
				}
			]
		}
	],
	"auth": {
		"type": "noauth"
	}
}
